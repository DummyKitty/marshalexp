package xyz.eki.marshalexp.exploit.ssti;

import org.thymeleaf.TemplateEngine;
import org.thymeleaf.context.Context;
import org.thymeleaf.templatemode.TemplateMode;
import org.thymeleaf.templateresolver.StringTemplateResolver;

public class ThymeleafSSTI {
    public static void main(String[] args) {
        // 创建 TemplateEngine 对象
        TemplateEngine templateEngine = new TemplateEngine();

        // 创建 StringTemplateResolver 对象
        StringTemplateResolver templateResolver = new StringTemplateResolver();
        templateResolver.setTemplateMode(TemplateMode.HTML);

        // 设置模板内容
        String templateContent = "<html><body><h1>Hello, [[name]]</h1></body></html>";

        // 渲染模板
        Context context = new Context();
        context.setVariable("name", "John Doe");
        String renderedHtml = templateEngine.process(templateContent, context);

        System.out.println(renderedHtml);
    }
}
